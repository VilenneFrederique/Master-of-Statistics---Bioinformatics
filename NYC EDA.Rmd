---
title: "NYC taxi trips EDA"
author: "Vilenne Frédérique"
date: "2-10-2021"
output: html_document
---

# Reading the data

```{r }
train <- read.csv("train.csv")
```

# Loading libraries

```{r}
library(tidyverse)
library(leaflet)
library(skimr)
library(ISLR)
library(ROCR)
```


# variables
Possible new variables to add:
  - Week or weekend
  - During peak hours for pick up time: Between 7-10am and 3-7pm
  - Holidays
  - Weather -> Practically impossible

Filtering values:
  - Trips going outside of NYC? Rationale: We focus on trip durations 

## Transformations
Transforming variables
```{r}
# Separating
train %>% separate(col = pickup_datetime, into = c("pickup_data", "pickup_time"), sep = " ", remove = FALSE) -> train_restructured
train_restructured %>% separate(col = dropoff_datetime, into = c("dropoff_data", "dropoff_time"), sep = " ", remove = FALSE) -> train_restructured
```

# Summary statistics
# Trip duration

Looking into the distribution of trip duration. This doesn't really add up. Impossible to travel this long.
```{r}
train %>% ggplot(aes(x = trip_duration)) + geom_histogram()
```

Looking at the highest values for trip duration to see about impossible values. Seems like there are 4 values probably incorrect. 
  - Value 3526282: From JFK airport to East 39th Street nr 101
  - Value 2227612: From East 27th Street nr 116 to Saint Mark's place nr 83
  - Value 2049578: From mid highway at the height of Queens midtown to 
  
Takes 538 hours for 1939736 seconds so thats impossible. Filter out
```{r}
train %>% arrange(desc(trip_duration)) %>% slice(1:20)
```

Filtering the dataset for valid trip durations
```{r}
train %>% filter(trip_duration < 100000) -> train_filtered
```


```{r}
train_filtered %>% ggplot(aes(x = trip_duration)) + geom_histogram(binwidth = 1000)
```



## Vendor
Looking at how often we had vendor 1 and vendor 2. Seems like vendor 2 was chosen quite more often. Namely 101964 times. This could be quite significant when modelling. Might want to be something we want to account for.  
```{r}
train_filtered %>% count(factor(vendor_id)) -> vendor_count
vendor_count[[2,2]] - vendor_count[[1,2]]
```



It looks like vendor 1 made shorter trips than vendor 2 after removing those outliers.Seems weird that vendor 2 makes 24h trips.
```{r}
train_filtered %>% ggplot(aes(x = factor(vendor_id), y = trip_duration / 3600, colour = factor(vendor_id))) + geom_boxplot() + geom_jitter(alpha = 0.5)
```

 

##


















